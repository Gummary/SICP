---
layout: post
title:  Exercise 5.10
date:   2016-12-02
description: Post on 02 December,2016 by Gummary
categories:
- blog
---

我添加的指令为beq，判断两个值是否相等，相等则跳转，否则顺序执行。判断的值可以为寄存器或者常量

~~~scheme
(beq <register-name> (reg <register-name>) (label <label-name>))
(beq <register-name> (const <const-value>) (label <label-name>))

(define (make-beq inst machine labels pc)
  (let ((first-reg (get-register machine (beq-first-exp inst)))
	(second-exp (beq-second-exp inst))
	(insts 
	  (lookup-label labels (label-exp-label (beq-dest inst)))))
    (let (second-value
	   (cond ((register-exp? second-exp)
		  (get-contents 
		    (get-register machine (register-exp-reg second-exp))))
		 ((constant-exp? second-exp)
		  (constant-exp-value second-exp))))
      (if (equal? (get-contents first-reg)
		  second-value)
	(set-contents pc insts)
	(advance-pc pc)))))


(define (beq-first-exp inst)
  (car inst))

(define (beq-second-exp inst)
  (cadr inst))

(define (beq-dest inst)
  (caddr inst))
~~~

  