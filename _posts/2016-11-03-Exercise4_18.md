---
layout: post
title:  Exercise 4.18
date:   2016-11-03
description: Post on 3 November,2016 by Gummary
categories:
- blog
---

采用练习4.18的定义

则solve过程首先变为

~~~scheme
(define (solve f y0 dt)
  (let ((y '*unassigned*)
	(dy '*unassigned*))
    (let ((a (integral (delay dy) y0 dt))
	  (b (stream f y)))
      y)))
~~~

然后在eval中let会转换成lambda表达式

~~~scheme
(define (solve f y0 dt)
  ((lambda (y dy)
     ((lambda (a b)
	(set! y a)
	(set! dy b))
      (integral (delay dy) y0 dt)
      (stream-map f y))
     y)
   '*unassigned
   '*unassigned))
~~~

在内部的lambda中，计算形参b的值的时候需要用到y的值，而此时y的值为*unassigned，所以不起作用

如果用正文的方式

首选变成let表达式

~~~scheme
(lambda (f y0 dt)
  (let ((y '*unsigned*)
	(dy '*unsigned*))
    (set! y (integral (delay dy) y0 dt))
    (set! dy (stream f y))
    y))
~~~

然后将let转化成lambda表达式

~~~scheme
(lambda (f y0 dt)
  ((lambda (y dt)
     (set! y (integral (delay dy) y0 dt))
     (set! dy (stream f y))
     y)
   '*unsigned*
   '*unsigned*))
~~~

可以看到，在使用y的时候已经用**set!**将y定义出来了，所以可以工作。

